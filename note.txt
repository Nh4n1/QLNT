--Đây là model sql mới

--
-- Cấu trúc bảng cho bảng `chi_tiet_hoa_don`
--

CREATE TABLE `chi_tiet_hoa_don` (
  `MaChiTiet` int(11) NOT NULL,
  `MaHoaDon` varchar(20) NOT NULL,
  `MaDichVu` int(11) NOT NULL,
  `SoLuong` float DEFAULT 0,
  `ChiSoCu` int(11) DEFAULT NULL,
  `ChiSoMoi` int(11) DEFAULT NULL,
  `DonGiaLuuTru` decimal(18,0) NOT NULL,
  `ThanhTien` decimal(18,0) NOT NULL,
  `GhiChu` varchar(255) DEFAULT NULL,
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;



--
-- Cấu trúc bảng cho bảng `cu_dan`
--

CREATE TABLE `cu_dan` (
  `Id` int(11) NOT NULL,
  `MaHopDong` varchar(20) NOT NULL,
  `MaNguoiThue` int(11) NOT NULL,
  `VaiTro` varchar(20) DEFAULT 'ThanhVien',
  `NgayVaoO` date DEFAULT curdate(),
  `NgayRoiDi` date DEFAULT NULL COMMENT 'NULL là đang ở',
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0,
  `deletedAt` timestamp NULL DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;



--
-- Cấu trúc bảng cho bảng `dang_ky_dich_vu`
--

CREATE TABLE `dang_ky_dich_vu` (
  `Id` int(11) NOT NULL,
  `MaHopDong` varchar(20) NOT NULL,
  `MaDichVu` int(11) NOT NULL,
  `SoLuong` int(11) DEFAULT 1,
  `DonGiaChot` decimal(18,0) DEFAULT NULL,
  `NgayDangKy` date DEFAULT curdate(),
  `NgayKetThuc` date DEFAULT NULL,
  `TrangThai` tinyint(1) DEFAULT 1,
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;


-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `dich_vu`
--

CREATE TABLE `dich_vu` (
  `MaDichVu` int(11) NOT NULL,
  `TenDichVu` varchar(100) NOT NULL,
  `DonGiaHienTai` decimal(18,0) DEFAULT 0,
  `DonViTinh` varchar(50) DEFAULT NULL,
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0,
  `deletedAt` timestamp NULL DEFAULT NULL,
  `LoaiDichVu` varchar(20) DEFAULT 'KhongChiSo' COMMENT 'Values: CoChiSo (Điện, Nước), KhongChiSo (Rác, Wifi, Xe)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;


-- Cấu trúc bảng cho bảng `hoa_don`
--

CREATE TABLE `hoa_don` (
  `MaHoaDon` varchar(20) NOT NULL,
  `MaHopDong` varchar(20) NOT NULL,
  `NgayLap` date NOT NULL,
  `TuNgay` date NOT NULL,
  `DenNgay` date NOT NULL,
  `TongTien` decimal(18,0) DEFAULT 0,
  `TrangThai` varchar(50) DEFAULT 'ChuaThanhToan',
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0,
  `deletedAt` timestamp NULL DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;


-- Cấu trúc bảng cho bảng `hop_dong`
--

CREATE TABLE `hop_dong` (
  `MaHopDong` varchar(20) NOT NULL,
  `MaPhong` int(11) NOT NULL,
  `MaNguoiThue` int(11) NOT NULL,
  `NgayBatDau` date NOT NULL,
  `NgayKetThuc` date DEFAULT NULL,
  `NgayTaoHopDong` date NOT NULL,
  `TienCoc` decimal(18,0) DEFAULT 0,
  `GiaThueChot` decimal(18,0) NOT NULL,
  `SoNguoiO` int(11) DEFAULT 1,
  `TrangThai` varchar(50) DEFAULT 'ConHieuLuc',
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0,
  `deletedAt` timestamp NULL DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;


CREATE TABLE `nguoi_thue` (
  `MaNguoiThue` int(11) NOT NULL,
  `CCCD` varchar(20) NOT NULL,
  `HoTen` varchar(100) NOT NULL,
  `GioiTinh` varchar(10) DEFAULT NULL,
  `NgaySinh` date DEFAULT NULL,
  `SDT` varchar(20) DEFAULT NULL,
  `Email` varchar(100) DEFAULT NULL,
  `DiaChi` varchar(255) DEFAULT NULL,
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0,
  `deletedAt` timestamp NULL DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

--

CREATE TABLE `nha_tro` (
  `MaNha` int(11) NOT NULL,
  `TenNha` varchar(100) NOT NULL,
  `DiaChi` varchar(255) DEFAULT NULL,
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0,
  `deletedAt` timestamp NULL DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;


--

CREATE TABLE `phieu_thu` (
  `MaPhieuThu` int(11) NOT NULL,
  `MaHoaDon` varchar(20) NOT NULL,
  `NgayThu` date NOT NULL,
  `SoTienThu` decimal(18,0) NOT NULL,
  `HinhThuc` varchar(50) DEFAULT 'TienMat',
  `GhiChu` varchar(255) DEFAULT NULL,
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0,
  `deletedAt` timestamp NULL DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;



CREATE TABLE `phong_tro` (
  `MaPhong` int(11) NOT NULL,
  `MaNha` int(11) NOT NULL,
  `TenPhong` varchar(50) NOT NULL,
  `GiaThueHienTai` decimal(18,0) DEFAULT 0,
  `SoNguoiToiDa` int(11) DEFAULT 1,
  `TrangThai` varchar(50) DEFAULT 'ConTrong',
  `createdAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `updatedAt` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `deleted` tinyint(1) DEFAULT 0,
  `deletedAt` timestamp NULL DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;



ALTER TABLE `chi_tiet_hoa_don`
  ADD PRIMARY KEY (`MaChiTiet`),
  ADD KEY `MaHoaDon` (`MaHoaDon`),
  ADD KEY `MaDichVu` (`MaDichVu`);

ALTER TABLE `cu_dan`
  ADD PRIMARY KEY (`Id`),
  ADD KEY `MaHopDong` (`MaHopDong`),
  ADD KEY `MaNguoiThue` (`MaNguoiThue`);


ALTER TABLE `dang_ky_dich_vu`
  ADD PRIMARY KEY (`Id`),
  ADD KEY `MaHopDong` (`MaHopDong`),
  ADD KEY `MaDichVu` (`MaDichVu`);

--
-- Chỉ mục cho bảng `dich_vu`
--
ALTER TABLE `dich_vu`
  ADD PRIMARY KEY (`MaDichVu`);

--
-- Chỉ mục cho bảng `hoa_don`
--
ALTER TABLE `hoa_don`
  ADD PRIMARY KEY (`MaHoaDon`),
  ADD KEY `MaHopDong` (`MaHopDong`);

--
-- Chỉ mục cho bảng `hop_dong`
--
ALTER TABLE `hop_dong`
  ADD PRIMARY KEY (`MaHopDong`),
  ADD KEY `MaPhong` (`MaPhong`),
  ADD KEY `MaNguoiThue` (`MaNguoiThue`);

--
-- Chỉ mục cho bảng `nguoi_thue`
--
ALTER TABLE `nguoi_thue`
  ADD PRIMARY KEY (`MaNguoiThue`),
  ADD UNIQUE KEY `CCCD` (`CCCD`);

--
-- Chỉ mục cho bảng `nha_tro`
--
ALTER TABLE `nha_tro`
  ADD PRIMARY KEY (`MaNha`);

--
-- Chỉ mục cho bảng `phieu_thu`
--
ALTER TABLE `phieu_thu`
  ADD PRIMARY KEY (`MaPhieuThu`),
  ADD KEY `MaHoaDon` (`MaHoaDon`);

--
-- Chỉ mục cho bảng `phong_tro`
--
ALTER TABLE `phong_tro`
  ADD PRIMARY KEY (`MaPhong`),
  ADD KEY `MaNha` (`MaNha`);

--
-- AUTO_INCREMENT cho các bảng đã đổ
--

--
-- AUTO_INCREMENT cho bảng `chi_tiet_hoa_don`
--
ALTER TABLE `chi_tiet_hoa_don`
  MODIFY `MaChiTiet` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=13;

--
-- AUTO_INCREMENT cho bảng `cu_dan`
--
ALTER TABLE `cu_dan`
  MODIFY `Id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=16;

--
-- AUTO_INCREMENT cho bảng `dang_ky_dich_vu`
--
ALTER TABLE `dang_ky_dich_vu`
  MODIFY `Id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=8;

--
-- AUTO_INCREMENT cho bảng `nguoi_thue`
--
ALTER TABLE `nguoi_thue`
  MODIFY `MaNguoiThue` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT cho bảng `phieu_thu`
--
ALTER TABLE `phieu_thu`
  MODIFY `MaPhieuThu` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

--
-- Các ràng buộc cho các bảng đã đổ
--

--
-- AUTO_INCREMENT cho bảng `dich_vu`
--
ALTER TABLE `dich_vu`
  MODIFY `MaDichVu` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=1;

--
-- AUTO_INCREMENT cho bảng `nha_tro`
--
ALTER TABLE `nha_tro`
  MODIFY `MaNha` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=1;

--
-- AUTO_INCREMENT cho bảng `phong_tro`
--
ALTER TABLE `phong_tro`
  MODIFY `MaPhong` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=1;


--
-- Các ràng buộc cho bảng `chi_tiet_hoa_don`
--
ALTER TABLE `chi_tiet_hoa_don`
  ADD CONSTRAINT `chi_tiet_hoa_don_ibfk_1` FOREIGN KEY (`MaHoaDon`) REFERENCES `hoa_don` (`MaHoaDon`),
  ADD CONSTRAINT `chi_tiet_hoa_don_ibfk_2` FOREIGN KEY (`MaDichVu`) REFERENCES `dich_vu` (`MaDichVu`);

--
-- Các ràng buộc cho bảng `cu_dan`
--
ALTER TABLE `cu_dan`
  ADD CONSTRAINT `cu_dan_ibfk_1` FOREIGN KEY (`MaHopDong`) REFERENCES `hop_dong` (`MaHopDong`),
  ADD CONSTRAINT `cu_dan_ibfk_2` FOREIGN KEY (`MaNguoiThue`) REFERENCES `nguoi_thue` (`MaNguoiThue`);

--
-- Các ràng buộc cho bảng `dang_ky_dich_vu`
--
ALTER TABLE `dang_ky_dich_vu`
  ADD CONSTRAINT `dang_ky_dich_vu_ibfk_1` FOREIGN KEY (`MaHopDong`) REFERENCES `hop_dong` (`MaHopDong`),
  ADD CONSTRAINT `dang_ky_dich_vu_ibfk_2` FOREIGN KEY (`MaDichVu`) REFERENCES `dich_vu` (`MaDichVu`);

--
-- Các ràng buộc cho bảng `hoa_don`
--
ALTER TABLE `hoa_don`
  ADD CONSTRAINT `hoa_don_ibfk_1` FOREIGN KEY (`MaHopDong`) REFERENCES `hop_dong` (`MaHopDong`);

--
-- Các ràng buộc cho bảng `hop_dong`
--
ALTER TABLE `hop_dong`
  ADD CONSTRAINT `hop_dong_ibfk_1` FOREIGN KEY (`MaPhong`) REFERENCES `phong_tro` (`MaPhong`),
  ADD CONSTRAINT `hop_dong_ibfk_2` FOREIGN KEY (`MaNguoiThue`) REFERENCES `nguoi_thue` (`MaNguoiThue`);

--
-- Các ràng buộc cho bảng `phieu_thu`
--
ALTER TABLE `phieu_thu`
  ADD CONSTRAINT `phieu_thu_ibfk_1` FOREIGN KEY (`MaHoaDon`) REFERENCES `hoa_don` (`MaHoaDon`);

--
-- Các ràng buộc cho bảng `phong_tro`
--
ALTER TABLE `phong_tro`
  ADD CONSTRAINT `phong_tro_ibfk_1` FOREIGN KEY (`MaNha`) REFERENCES `nha_tro` (`MaNha`);
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
